<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>File Test</title>
  <script type='text/javascript'>
    // var file = document.getElementById("file").files[0];
    // var reader = new FileReader();
    // reader.onload = function(e){
    //   console.log(e.target.result);
    // }
    // reader.readAsText(file);
    
    // const fileSelector = document.getElementById('file');
    // fileSelector.addEventListener('change', (event) => {
    //   const fileList = event.target.files;
    //   console.log(fileList);
    // });
    


    function fileCheck() {

      // input file 에서 fileList 꺼내기
      const fileSelector = document.getElementById('file');
      const fileList = fileSelector.files;
      console.log(fileList);
      
      for (const file of fileList) {
        console.log(file);
        // Not supported in Safari for iOS.
        const name = file.name ? file.name : 'NOT SUPPORTED';
        // Not supported in Firefox for Android or Opera for Android.
        const type = file.type ? file.type : 'NOT SUPPORTED';
        // Unknown cross-browser support.
        const size = file.size ? file.size : 'NOT SUPPORTED';
        // console.log({file, name, type, size});
        
        
        const reader = new FileReader();
        reader.addEventListener('load', (event) => {
          console.log('reader', event.target.result)

          // // 사용자가 올린 파일을 다시 file로 변환
          // var memFile = dataURLtoFile(event.target.result, name);
          // console.log(memFile);
        });
        reader.readAsDataURL(file);
        
      }
      
      // // 예시로 file로 변환
      // var filee = dataURLtoFile('data:text/plain;base64,aGVsbG8gd29ybGQ=','hello.txt');
      // console.log(filee);


    }

    // dataURL -> file로 변환 함수
    function dataURLtoFile(dataurl, filename) {
 
      var arr = dataurl.split(','),
          mime = arr[0].match(/:(.*?);/)[1],
          bstr = atob(arr[1]), 
          n = bstr.length, 
          u8arr = new Uint8Array(n);
          
      while(n--){
          u8arr[n] = bstr.charCodeAt(n);
      }
      
      return new File([u8arr], filename, {type:mime});

    }


    // function sshclient(dataurl, filename) {

    // }

    // 웹 퍼포먼스 모니터링 : 페이지 로딩 시간 측정
    window.onload = function(){
      setTimeout(function(){
        var t = performance.timing;
        console.log("네트워크 지연시간 (): ", t.responseEnd - t.fetchStart, "ms");
        console.log("서버에서 페이지를 받고 페이지를 로드하는데 걸린 시간: ", t.loadEventEnd - t.responseEnd, "ms");
        console.log("탐색과 페이지 로드의 전체 과정: ", t.loadEventEnd - t.navigationStart, "ms");
      }, 0);
    }

  </script>
</head>
<body>
  <input type="file" id="file">
  <input type='button' value='확인' onclick='fileCheck()'>
  <!-- 1. 유저이름 2. 호스트 (1, 2는 글자입력 input) 3. private key -->

  <!-- <input type='button' value='확인' onclick='sshclient()'> -->
</body>
</html>